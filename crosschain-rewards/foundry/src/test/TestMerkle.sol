// SPDX-License-Identifier: GPL-3.0
pragma solidity 0.8.19;

import "forge-std/console.sol";
import {Setup} from "./utils/Setup.sol";
import {ERC20} from "@openzeppelin/contracts/token/ERC20/ERC20.sol";

contract OperationTest is Setup {
    mapping(address => bytes[]) proofs;

    function setUp() public override {
        super.setUp();
    }

    function testMerkleClaim() public {
        bytes32 merkleRoot = 0xbb7d7382954849916f37091ddbb5add6d492078386eb2665d3fa834305c895a5;
        uint256 blockNumber = 108080039;
        uint256 totalStakedBalance = 10065976484417347667174646;
        uint256 rewardsToDistribute = 1_000_000  * 1e18; // e.g. 1,000,000 SONNE

        // Alice
        proofs[alice] = new bytes[](5);
        proofs[alice][0] =
            hex"f90211a08abd3bf0735f6c8af16b465c444641c4a4ce26a6ccb10b590eae1019ca6d91bea0a9b5dd537be664137b662a77c373714676f4083f7ad4d9ac5039d12bfbf5bf2ea0fe64994de8dcb6ee57ed536f76615cdfe5715cfe6c4c3d9d3672f9e50a906575a0788b6efd7d68a2e10de135d0d30a428b4cc48c8c0091bc6839c69f88a275fc0ba002a76ef963d5b7dac1a5203f7c21f95edb19116c598f617b164922557fe7fcfba0e2cf31c1453885eb0fea89990b965c98f6c87a990e3a781df014ff3b13abe782a0afab23c0e37eb0486d9a967737eaca36f11b64cad00415ba397336811cb5f1c1a0be4341e706c7253078250713f61928a258d1d1e8603d9549eebea97c35ec1370a04315d3979e23e56c31185b5ceab1837df84aa2b429015470e070ad26767291f4a04375376e8361af86f013615dd42ecf459165155cffaaea9db11cdba2034f87b8a06d14c99f2e7443722c789ccd1515ea3881be2450a4a998855111dbaf34b20ae9a01db567b050a6ff3b76a5b3eaf94dc25355e62204db658fbe452f8ab2342fd2aca0c62d202f910310df3ea4160682c668b0b3a311f512c281f16eda7b8c22718d10a0db1406019172879c8967003ab11be60bc817bdf6de46f7d66ed6b8c9465b74dda070656f49d5fdbc42816e002cb75d777e2d37d7c3a8cf65cae138a5ea4c743114a066fb69cc78267a40a8b2e3f3205228c35479068f7ab29fa11279852fa8ae074980";
        proofs[alice][1] =
            hex"f90211a047db99358cb37ae0938f09a1e16786c361c3b3c9c43884e460f76ba2ac53eb0ea0bade11c065afb364417e1527517b849301ac8377311db25a0180274718d859dca0c2e8d820500faa647febe228cbeb88e01cce1e93c976f6e44a275f478100e331a05f67de958a47dace123e30f426117357b66e94932dd58abe4030b31651b75e12a0f63ef2fff6404143b8c2b8ff2585ba0bdc2aa1a36d695d9d80d197665ad2317ba0b9c9304e8f3651c9507d111ac2cf887636c845e9049094dc7beed44f3b8fcfbca0dcffef62a0a776b95d90fc3ac1875881fb02dd1e9d5524433891cb2058c9f67ba0a25cba82b7c1f56389b20b68d290426022449aedd9bf8bc6dc7470c1dcd68775a049697b357d6a9f4386cf76fde1e1bc7447392486593d23e43019007055d93cb8a00c401f8142b410da82fc3ae86498b71a39de6ba4ee101a3538a5d6a851fd515ea02f0ad57be386dc119e3b92d629f03f537db644674b91389aa9558f73d1bf1fb7a0daa5505c26a279b8ef07237b510cf6bcf01f63bdffcfeb6e36fd3e1a02cdc850a05953d5ba6ee7e9d1e2dcca261882ab36bf1835de80ae7e6aa79bcb2fdfee9b20a0c65cfef74c901cf85c42c57fdbb7c54a14179e90c0d219fc5be579a9a55e56eda04f90b2da3d6fd331d0c560ae3503197792f6888465bf26a6e75cdca6eb8246b6a0dd6294bd7b4756a370151f772c711a8ad4c3db674704e40b95eee073ee94648980";
        proofs[alice][2] =
            hex"f90191a076d51a3b3db08f41066db327988d44d6ddf3c56cede3d779665fac805f83102580a0f575edba68e1fe7af5a4114e7bf018ffaad2299a50e93d045bf63948c672e0aca002e55b1f036469e089e2540e96b32b6705ce2daeb501b3635b0ff2f4034f3c4d8080a0265bd08a6145dea879320e7cbe9f324d7b8f60c9f437102fa6f1c59db053928ca0989b9cc1a561266218fadb81efe2c09da5b3ebd1cee7f1e6d040813340f6f7caa0e676c11dc59dd2bf86087a4d0361f7d4c6da8b88d59f19c8e30baed1ffa59e41a0d65aef482da5d8aec552b1d4dc3c0da524417cee708bef5fe55df8f4cb0c58ef80a04a09f1f198af358646e90736eb69231fca3ed2640d669792c77d1c28bad66c67a0ee35f0573a1436e25462729aa6053c9aa202708119ab0822fa338e92f84b574aa012e53738e09238f2bf225b636a321256ce62112014719952a905b5f32829d1eba01b0aed7e549bf4ea3fd6458aedf9acfab5710c35f879103a51389fa30cbba60fa07be7c88782b9f205adebe80484b36ada7cb23ad4a8d93feba2823ff3c8c5e0ac80";
        proofs[alice][3] =
            hex"f851a05927a5f106de9e816bba621350ecefdcb3bad1832718128a1243646a9de0a5b88080808080808080808080a0499280066e6025305c59d623a6235b822915170b1fd835da9d45edff90f0f82680808080";
        proofs[alice][4] =
            hex"ec9f208b8f70e5ac7d4318dffb52f0e48050e1c9db919a29eabde8f3cd496b7a778b8a40348143698d45800000";

        // Bob
        proofs[bob] = new bytes[](5);
        proofs[bob][0] =
            hex"f90211a08abd3bf0735f6c8af16b465c444641c4a4ce26a6ccb10b590eae1019ca6d91bea0a9b5dd537be664137b662a77c373714676f4083f7ad4d9ac5039d12bfbf5bf2ea0fe64994de8dcb6ee57ed536f76615cdfe5715cfe6c4c3d9d3672f9e50a906575a0788b6efd7d68a2e10de135d0d30a428b4cc48c8c0091bc6839c69f88a275fc0ba002a76ef963d5b7dac1a5203f7c21f95edb19116c598f617b164922557fe7fcfba0e2cf31c1453885eb0fea89990b965c98f6c87a990e3a781df014ff3b13abe782a0afab23c0e37eb0486d9a967737eaca36f11b64cad00415ba397336811cb5f1c1a0be4341e706c7253078250713f61928a258d1d1e8603d9549eebea97c35ec1370a04315d3979e23e56c31185b5ceab1837df84aa2b429015470e070ad26767291f4a04375376e8361af86f013615dd42ecf459165155cffaaea9db11cdba2034f87b8a06d14c99f2e7443722c789ccd1515ea3881be2450a4a998855111dbaf34b20ae9a01db567b050a6ff3b76a5b3eaf94dc25355e62204db658fbe452f8ab2342fd2aca0c62d202f910310df3ea4160682c668b0b3a311f512c281f16eda7b8c22718d10a0db1406019172879c8967003ab11be60bc817bdf6de46f7d66ed6b8c9465b74dda070656f49d5fdbc42816e002cb75d777e2d37d7c3a8cf65cae138a5ea4c743114a066fb69cc78267a40a8b2e3f3205228c35479068f7ab29fa11279852fa8ae074980";
        proofs[bob][1] =
            hex"f90211a035a61b32334ff1db83ba353ce7dea0655b68d4565e0ca4b645868168c7169932a0f0d74db2c58a7c797abeedf0e5307ef159ad4bc1a2cf8237da8f5e7f73b674a7a02215fc8e414530c7af15e80fb5eb58b9d77c3dfd02e7cb341451aed0c53194a9a0ef21029cb9f4f5f0f642f1d1874a765a968c746fca4dcca93555b71de293c920a065b9e203ea0febc5a2c267492665a2fa2b07698bf0afe263feb7c0e4e56e4a88a0bd500854b6deb150a6c9e7d9735df6e104442595e60750432245508c723f8473a08fb4b814dda000ceba20d9ea2b0da1a6e317a3a6305f2a938a6c68937f063571a05ce7ee750a17d11695347b93bc6982c7254a58b712a8e5ea0cdcb1d640c301f0a06d8deb65cfeac289d05afa4d67e1e41e8d0f21db29c9842fa11712783f76f961a08c679ee7d43ee9fd332a154d85b4633130ab30243ae0d82f2436508d24465ffca090ab4ad2718c0a808693b1641d558ba1220058cf692028626cc5552e33c2abaaa06d748a75c8cecd77eabd1c760c5d0fba460fd374c07c4dc90be824d0319466aaa0741e7bd9630617d50dc550ed43ee55c67d0167846c551882099b055645eb9165a02c026bfb03c046c039b46254468b819101c9ddbc3371d6b4a5fd7cf76c5e5752a09dbbbc6c51ef954ed3e01f13dd2e4339b6cc53a77b068085804c955a8f13806aa039dbbbcdd8b8bb8a74a1314411fef608977f247bb9842fb18b0f095bb59cb02f80";
        proofs[bob][2] =
            hex"f90171a0a9add3527e1a412b4090f9e99891791f58886d9e1f196cd4e332350de3316beca07a1d42f1091a7d1149d5f92134aff178e2e8a496249447b2a64d7f69bae2c93ba0f927578899d52766cda6efbd2af44be57bcbdacd0c95cc8bec06f776117a8c6380a0364abca82e680a9c42971e08e72caa9a3ff9f2d700a066b72935fa6d8f9279b6a0a7dc31fdd3ac4b46ca4010fa37a34e04468ad3c20120a3a7e60dd95ba5ab56c8a02dacd128f54d9311db4cbfe8d01b56d4921cf265b938b2f38e3c8942400d7c1ea0c659cc93f0fb26484d1998355fdeacf106a39ab08eed4f80fb2c3b31be9ff988a0a660a4e865e190d91101691f22b2000af98169f1e6a12faf61d30ca6a1534171a029cc1010ec11de701af6c0d80213325429bb5ae51ae63e1d7515b4861c251eefa032ee88e4431c84101751b98e8c7b155fb970715fa9f1968efa28873e14a303f98080a0099be9346755a2855229cd3f76e4af5455aa896d659a3135c48fdc5eb737e7ae808080";
        proofs[bob][3] =
            hex"f87180a09500bed5f69925e8e56b5eca5fd401d2bcea75345714463e2e60a98bb07a7c7c80a0ad1a1d6bc4386230802b5458a215ea265015d3f66d493b9670be435617f4a49a808080808080a04719db31c9528548dd84a965c46b48f8816c6dd6169f546b640e3ed4f9fd34e6808080808080";
        proofs[bob][4] = hex"ec9f200f23e9eeb794cd6b8f3944813b838b1099508a8f733f35e63e6d979a93c58b8a055888c0d241f0540000";

        // Charlie
        proofs[charlie] = new bytes[](5);
        proofs[charlie][0] =
            hex"f90211a08abd3bf0735f6c8af16b465c444641c4a4ce26a6ccb10b590eae1019ca6d91bea0a9b5dd537be664137b662a77c373714676f4083f7ad4d9ac5039d12bfbf5bf2ea0fe64994de8dcb6ee57ed536f76615cdfe5715cfe6c4c3d9d3672f9e50a906575a0788b6efd7d68a2e10de135d0d30a428b4cc48c8c0091bc6839c69f88a275fc0ba002a76ef963d5b7dac1a5203f7c21f95edb19116c598f617b164922557fe7fcfba0e2cf31c1453885eb0fea89990b965c98f6c87a990e3a781df014ff3b13abe782a0afab23c0e37eb0486d9a967737eaca36f11b64cad00415ba397336811cb5f1c1a0be4341e706c7253078250713f61928a258d1d1e8603d9549eebea97c35ec1370a04315d3979e23e56c31185b5ceab1837df84aa2b429015470e070ad26767291f4a04375376e8361af86f013615dd42ecf459165155cffaaea9db11cdba2034f87b8a06d14c99f2e7443722c789ccd1515ea3881be2450a4a998855111dbaf34b20ae9a01db567b050a6ff3b76a5b3eaf94dc25355e62204db658fbe452f8ab2342fd2aca0c62d202f910310df3ea4160682c668b0b3a311f512c281f16eda7b8c22718d10a0db1406019172879c8967003ab11be60bc817bdf6de46f7d66ed6b8c9465b74dda070656f49d5fdbc42816e002cb75d777e2d37d7c3a8cf65cae138a5ea4c743114a066fb69cc78267a40a8b2e3f3205228c35479068f7ab29fa11279852fa8ae074980";
        proofs[charlie][1] =
            hex"f90211a035a61b32334ff1db83ba353ce7dea0655b68d4565e0ca4b645868168c7169932a0f0d74db2c58a7c797abeedf0e5307ef159ad4bc1a2cf8237da8f5e7f73b674a7a02215fc8e414530c7af15e80fb5eb58b9d77c3dfd02e7cb341451aed0c53194a9a0ef21029cb9f4f5f0f642f1d1874a765a968c746fca4dcca93555b71de293c920a065b9e203ea0febc5a2c267492665a2fa2b07698bf0afe263feb7c0e4e56e4a88a0bd500854b6deb150a6c9e7d9735df6e104442595e60750432245508c723f8473a08fb4b814dda000ceba20d9ea2b0da1a6e317a3a6305f2a938a6c68937f063571a05ce7ee750a17d11695347b93bc6982c7254a58b712a8e5ea0cdcb1d640c301f0a06d8deb65cfeac289d05afa4d67e1e41e8d0f21db29c9842fa11712783f76f961a08c679ee7d43ee9fd332a154d85b4633130ab30243ae0d82f2436508d24465ffca090ab4ad2718c0a808693b1641d558ba1220058cf692028626cc5552e33c2abaaa06d748a75c8cecd77eabd1c760c5d0fba460fd374c07c4dc90be824d0319466aaa0741e7bd9630617d50dc550ed43ee55c67d0167846c551882099b055645eb9165a02c026bfb03c046c039b46254468b819101c9ddbc3371d6b4a5fd7cf76c5e5752a09dbbbc6c51ef954ed3e01f13dd2e4339b6cc53a77b068085804c955a8f13806aa039dbbbcdd8b8bb8a74a1314411fef608977f247bb9842fb18b0f095bb59cb02f80";
        proofs[charlie][2] =
            hex"f90151a077d45ed2eab47946b1642df26da6fe34adf83cb72612813de5686ebfd6e5a6a0a06a8100cefd6a1ee7e5a51e18370335e33a99c77b4b87a85f2173d9d39536445da0a7e3960f00ec6759924bf28395d55271fc8b4a4e0e9ddc6772ae7da769f0032ea0646be174586a3e45e368056e73d83d0a4125b42aaf989a174116e3e40675706d80a072330cac43f1642b8ad0c260c7d987d4d15d79e4b5bba6e9a21b651190b2234da01c5e5607c09079e32f1475514cc66a12b8a11e66aa1fad40e8366a7ee750cf1aa0a16038d6e305cb9e5be8a9e5dd3ec446738dd84fd54e8d5d840c41fd94d9619980808080a0568ac643819e5f5da88303cb599aa3f4eef49dcb632e833f0516fcdd97dd179080a088061e5b61ff03e482f75f80152e8c2c184213eafba35123fcf9e90297fda7cea0cbbce5379ddd15d05dafcf654213649378db1a1a889bf949b01aa3851ee8022880";
        proofs[charlie][3] =
            hex"f8718080a0df6daadb808cebc640643e94538dae83d15cd5154bf7338960b758c8ec6f1f2e8080808080a0edb51705685fa2adc2b9aff6671fb5ef50960e2576a5f9b518a2afff17d054e480a07ba9c58fa18549854d98b3a1f7403ecdaf930c725773dc3d8e4705b80523bdeb808080808080";
        proofs[charlie][4] =
            hex"ec9f20c7e46b9229ee478e04da93466bc9588a23ba2d51453e79a046c4018444908b8a6600e4bed9f8356dc4a1";

        box.addReward(rewardsToDistribute, merkleRoot, blockNumber, 0, totalStakedBalance);

        vm.prank(alice);
        box.claim(blockNumber, proofs[alice]);
        
        vm.prank(bob);
        box.claim(blockNumber, proofs[bob]);

        vm.prank(charlie);
        box.claim(blockNumber, proofs[charlie]);
    }

    function testMerkleClaimInvalidProofReverts() public {
        bytes32 merkleRoot = 0xbb7d7382954849916f37091ddbb5add6d492078386eb2665d3fa834305c895a5;
        uint256 blockNumber = 108080039;
        uint256 totalStakedBalance = 10065976484417347667174646;
        uint256 rewardsToDistribute = 1_000_000  * 1e18; // e.g. 1,000,000 SONNE

        // Alice
        proofs[alice] = new bytes[](5);
        proofs[alice][0] =
            hex"f90211a08abd3bf0735f6c8af16b465c444641c4a4ce26a6ccb10b590eae1019ca6d91bea0a9b5dd537be664137b662a77c373714676f4083f7ad4d9ac5039d12bfbf5bf2ea0fe64994de8dcb6ee57ed536f76615cdfe5715cfe6c4c3d9d3672f9e50a906575a0788b6efd7d68a2e10de135d0d30a428b4cc48c8c0091bc6839c69f88a275fc0ba002a76ef963d5b7dac1a5203f7c21f95edb19116c598f617b164922557fe7fcfba0e2cf31c1453885eb0fea89990b965c98f6c87a990e3a781df014ff3b13abe782a0afab23c0e37eb0486d9a967737eaca36f11b64cad00415ba397336811cb5f1c1a0be4341e706c7253078250713f61928a258d1d1e8603d9549eebea97c35ec1370a04315d3979e23e56c31185b5ceab1837df84aa2b429015470e070ad26767291f4a04375376e8361af86f013615dd42ecf459165155cffaaea9db11cdba2034f87b8a06d14c99f2e7443722c789ccd1515ea3881be2450a4a998855111dbaf34b20ae9a01db567b050a6ff3b76a5b3eaf94dc25355e62204db658fbe452f8ab2342fd2aca0c62d202f910310df3ea4160682c668b0b3a311f512c281f16eda7b8c22718d10a0db1406019172879c8967003ab11be60bc817bdf6de46f7d66ed6b8c9465b74dda070656f49d5fdbc42816e002cb75d777e2d37d7c3a8cf65cae138a5ea4c743114a066fb69cc78267a40a8b2e3f3205228c35479068f7ab29fa11279852fa8ae074980";
        proofs[alice][1] =
            hex"f90211a047db99358cb37ae0938f09a1e16786c361c3b3c9c43884e460f76ba2ac53eb0ea0bade11c065afb364417e1527517b849301ac8377311db25a0180274718d859dca0c2e8d820500faa647febe228cbeb88e01cce1e93c976f6e44a275f478100e331a05f67de958a47dace123e30f426117357b66e94932dd58abe4030b31651b75e12a0f63ef2fff6404143b8c2b8ff2585ba0bdc2aa1a36d695d9d80d197665ad2317ba0b9c9304e8f3651c9507d111ac2cf887636c845e9049094dc7beed44f3b8fcfbca0dcffef62a0a776b95d90fc3ac1875881fb02dd1e9d5524433891cb2058c9f67ba0a25cba82b7c1f56389b20b68d290426022449aedd9bf8bc6dc7470c1dcd68775a049697b357d6a9f4386cf76fde1e1bc7447392486593d23e43019007055d93cb8a00c401f8142b410da82fc3ae86498b71a39de6ba4ee101a3538a5d6a851fd515ea02f0ad57be386dc119e3b92d629f03f537db644674b91389aa9558f73d1bf1fb7a0daa5505c26a279b8ef07237b510cf6bcf01f63bdffcfeb6e36fd3e1a02cdc850a05953d5ba6ee7e9d1e2dcca261882ab36bf1835de80ae7e6aa79bcb2fdfee9b20a0c65cfef74c901cf85c42c57fdbb7c54a14179e90c0d219fc5be579a9a55e56eda04f90b2da3d6fd331d0c560ae3503197792f6888465bf26a6e75cdca6eb8246b6a0dd6294bd7b4756a370151f772c711a8ad4c3db674704e40b95eee073ee94648980";
        proofs[alice][2] =
            hex"f90191a076d51a3b3db08f41066db327988d44d6ddf3c56cede3d779665fac805f83102580a0f575edba68e1fe7af5a4114e7bf018ffaad2299a50e93d045bf63948c672e0aca002e55b1f036469e089e2540e96b32b6705ce2daeb501b3635b0ff2f4034f3c4d8080a0265bd08a6145dea879320e7cbe9f324d7b8f60c9f437102fa6f1c59db053928ca0989b9cc1a561266218fadb81efe2c09da5b3ebd1cee7f1e6d040813340f6f7caa0e676c11dc59dd2bf86087a4d0361f7d4c6da8b88d59f19c8e30baed1ffa59e41a0d65aef482da5d8aec552b1d4dc3c0da524417cee708bef5fe55df8f4cb0c58ef80a04a09f1f198af358646e90736eb69231fca3ed2640d669792c77d1c28bad66c67a0ee35f0573a1436e25462729aa6053c9aa202708119ab0822fa338e92f84b574aa012e53738e09238f2bf225b636a321256ce62112014719952a905b5f32829d1eba01b0aed7e549bf4ea3fd6458aedf9acfab5710c35f879103a51389fa30cbba60fa07be7c88782b9f205adebe80484b36ada7cb23ad4a8d93feba2823ff3c8c5e0ac80";
        proofs[alice][3] =
            hex"f851a05927a5f106de9e816bba621350ecefdcb3bad1832718128a1243646a9de0a5b88080808080808080808080a0499280066e6025305c59d623a6235b822915170b1fd835da9d45edff90f0f82680808080";
        proofs[alice][4] =
            hex"ec9f208b7f70e5ac7d4318dffb52f0e48050e1c9db919a29eabde8f3cd496b7a778b8a40348143698d45800000";

        // Bob
        proofs[bob] = new bytes[](5);
        proofs[bob][0] =
            hex"f90211a08abd3bf0735f6c8af16b465c444641c4a4ce26a6ccb10b590eae1019ca6d91bea0a9b5dd537be664137b662a77c373714676f4083f7ad4d9ac5039d12bfbf5bf2ea0fe64994de8dcb6ee57ed536f76615cdfe5715cfe6c4c3d9d3672f9e50a906575a0788b6efd7d68a2e10de135d0d30a428b4cc48c8c0091bc6839c69f88a275fc0ba002a76ef963d5b7dac1a5203f7c21f95edb19116c598f617b164922557fe7fcfba0e2cf31c1453885eb0fea89990b965c98f6c87a990e3a781df014ff3b13abe782a0afab23c0e37eb0486d9a967737eaca36f11b64cad00415ba397336811cb5f1c1a0be4341e706c7253078250713f61928a258d1d1e8603d9549eebea97c35ec1370a04315d3979e23e56c31185b5ceab1837df84aa2b429015470e070ad26767291f4a04375376e8361af86f013615dd42ecf459165155cffaaea9db11cdba2034f87b8a06d14c99f2e7443722c789ccd1515ea3881be2450a4a998855111dbaf34b20ae9a01db567b050a6ff3b76a5b3eaf94dc25355e62204db658fbe452f8ab2342fd2aca0c62d202f910310df3ea4160682c668b0b3a311f512c281f16eda7b8c22718d10a0db1406019172879c8967003ab11be60bc817bdf6de46f7d66ed6b8c9465b74dda070656f49d5fdbc42816e002cb75d777e2d37d7c3a8cf65cae138a5ea4c743114a066fb69cc78267a40a8b2e3f3205228c35479068f7ab29fa11279852fa8ae074980";
        proofs[bob][1] =
            hex"f90211a025a61b32334ff1db83ba353ce7dea0655b68d4565e0ca4b645868168c7169932a0f0d74db2c58a7c797abeedf0e5307ef159ad4bc1a2cf8237da8f5e7f73b674a7a02215fc8e414530c7af15e80fb5eb58b9d77c3dfd02e7cb341451aed0c53194a9a0ef21029cb9f4f5f0f642f1d1874a765a968c746fca4dcca93555b71de293c920a065b9e203ea0febc5a2c267492665a2fa2b07698bf0afe263feb7c0e4e56e4a88a0bd500854b6deb150a6c9e7d9735df6e104442595e60750432245508c723f8473a08fb4b814dda000ceba20d9ea2b0da1a6e317a3a6305f2a938a6c68937f063571a05ce7ee750a17d11695347b93bc6982c7254a58b712a8e5ea0cdcb1d640c301f0a06d8deb65cfeac289d05afa4d67e1e41e8d0f21db29c9842fa11712783f76f961a08c679ee7d43ee9fd332a154d85b4633130ab30243ae0d82f2436508d24465ffca090ab4ad2718c0a808693b1641d558ba1220058cf692028626cc5552e33c2abaaa06d748a75c8cecd77eabd1c760c5d0fba460fd374c07c4dc90be824d0319466aaa0741e7bd9630617d50dc550ed43ee55c67d0167846c551882099b055645eb9165a02c026bfb03c046c039b46254468b819101c9ddbc3371d6b4a5fd7cf76c5e5752a09dbbbc6c51ef954ed3e01f13dd2e4339b6cc53a77b068085804c955a8f13806aa039dbbbcdd8b8bb8a74a1314411fef608977f247bb9842fb18b0f095bb59cb02f80";
        proofs[bob][2] =
            hex"f90171a0a9add3527e1a412b4090f9e99891791f58886d9e1f196cd4e332350de3316beca07a1d42f1091a7d1149d5f92134aff178e2e8a496249447b2a64d7f69bae2c93ba0f927578899d52766cda6efbd2af44be57bcbdacd0c95cc8bec06f776117a8c6380a0364abca82e680a9c42971e08e72caa9a3ff9f2d700a066b72935fa6d8f9279b6a0a7dc31fdd3ac4b46ca4010fa37a34e04468ad3c20120a3a7e60dd95ba5ab56c8a02dacd128f54d9311db4cbfe8d01b56d4921cf265b938b2f38e3c8942400d7c1ea0c659cc93f0fb26484d1998355fdeacf106a39ab08eed4f80fb2c3b31be9ff988a0a660a4e865e190d91101691f22b2000af98169f1e6a12faf61d30ca6a1534171a029cc1010ec11de701af6c0d80213325429bb5ae51ae63e1d7515b4861c251eefa032ee88e4431c84101751b98e8c7b155fb970715fa9f1968efa28873e14a303f98080a0099be9346755a2855229cd3f76e4af5455aa896d659a3135c48fdc5eb737e7ae808080";
        proofs[bob][3] =
            hex"f87180a09500bed5f69925e8e56b5eca5fd401d2bcea75345714463e2e60a98bb07a7c7c80a0ad1a1d6bc4386230802b5458a215ea265015d3f66d493b9670be435617f4a49a808080808080a04719db31c9528548dd84a965c46b48f8816c6dd6169f546b640e3ed4f9fd34e6808080808080";
        proofs[bob][4] = hex"ec9f200f23e9eeb794cd6b8f3944813b838b1099508a8f733f35e63e6d979a93c58b8a055888c0d241f0540000";

        // Charlie
        proofs[charlie] = new bytes[](5);
        proofs[charlie][0] =
            hex"f90211a08abd3bf0735f6c8af16b465c444641c4a4ce26a6ccb10b590eae1019ca6d91bea0a9b5dd537be664137b662a77c373714676f4083f7ad4d9ac5039d12bfbf5bf2ea0fe64994de8dcb6ee57ed536f76615cdfe5715cfe6c4c3d9d3672f9e50a906575a0788b6efd7d68a2e10de135d0d30a428b4cc48c8c0091bc6839c69f88a275fc0ba002a76ef963d5b7dac1a5203f7c21f95edb19116c598f617b164922557fe7fcfba0e2cf31c1453885eb0fea89990b965c98f6c87a990e3a781df014ff3b13abe782a0afab23c0e37eb0486d9a967737eaca36f11b64cad00415ba397336811cb5f1c1a0be4341e706c7253078250713f61928a258d1d1e8603d9549eebea97c35ec1370a04315d3979e23e56c31185b5ceab1837df84aa2b429015470e070ad26767291f4a04375376e8361af86f013615dd42ecf459165155cffaaea9db11cdba2034f87b8a06d14c99f2e7443722c789ccd1515ea3881be2450a4a998855111dbaf34b20ae9a01db567b050a6ff3b76a5b3eaf94dc25355e62204db658fbe452f8ab2342fd2aca0c62d202f910310df3ea4160682c668b0b3a311f512c281f16eda7b8c22718d10a0db1406019172879c8967003ab11be60bc817bdf6de46f7d66ed6b8c9465b74dda070656f49d5fdbc42816e002cb75d777e2d37d7c3a8cf65cae138a5ea4c743114a066fb69cc78267a40a8b2e3f3205228c35479068f7ab29fa11279852fa8ae074980";
        proofs[charlie][1] =
            hex"f90211a035a61b32334ff1db83ba353ce7dea0655b68d4565e0ca4b645868168c7169932a0f0d74db2c58a7c797abeedf0e5307ef159ad4bc1a2cf8237da8f5e7f73b674a7a02215fc8e414530c7af15e80fb5eb58b9d77c3dfd02e7cb341451aed0c53194a9a0ef21029cb9f4f5f0f642f1d1874a765a968c746fca4dcca93555b71de293c920a065b9e203ea0febc5a2c267492665a2fa2b07698bf0afe263feb7c0e4e56e4a88a0bd500854b6deb150a6c9e7d9735df6e104442595e60750432245508c723f8473a08fb4b814dda000ceba20d9ea2b0da1a6e317a3a6305f2a938a6c68937f063571a05ce7ee750a17d11695347b93bc6982c7254a58b712a8e5ea0cdcb1d640c301f0a06d8deb65cfeac289d05afa4d67e1e41e8d0f21db29c9842fa11712783f76f961a08c679ee7d43ee9fd332a154d85b4633130ab30243ae0d82f2436508d24465ffca090ab4ad2718c0a808693b1641d558ba1220058cf692028626cc5552e33c2abaaa06d748a75c8cecd77eabd1c760c5d0fba460fd374c07c4dc90be824d0319466aaa0741e7bd9630617d50dc550ed43ee55c67d0167846c551882099b055645eb9165a02c026bfb03c046c039b46254468b819101c9ddbc3371d6b4a5fd7cf76c5e5752a09dbbbc6c51ef954ed3e01f13dd2e4339b6cc53a77b068085804c955a8f13806aa039dbbbcdd8b8bb8a74a1314411fef608977f247bb9842fb18b0f095bb59cb02f80";
        proofs[charlie][2] =
            hex"f90151a067d45ed2eab47946b1642df26da6fe34adf83cb72612813de5686ebfd6e5a6a0a06a8100cefd6a1ee7e5a51e18370335e33a99c77b4b87a85f2173d9d39536445da0a7e3960f00ec6759924bf28395d55271fc8b4a4e0e9ddc6772ae7da769f0032ea0646be174586a3e45e368056e73d83d0a4125b42aaf989a174116e3e40675706d80a072330cac43f1642b8ad0c260c7d987d4d15d79e4b5bba6e9a21b651190b2234da01c5e5607c09079e32f1475514cc66a12b8a11e66aa1fad40e8366a7ee750cf1aa0a16038d6e305cb9e5be8a9e5dd3ec446738dd84fd54e8d5d840c41fd94d9619980808080a0568ac643819e5f5da88303cb599aa3f4eef49dcb632e833f0516fcdd97dd179080a088061e5b61ff03e482f75f80152e8c2c184213eafba35123fcf9e90297fda7cea0cbbce5379ddd15d05dafcf654213649378db1a1a889bf949b01aa3851ee8022880";
        proofs[charlie][3] =
            hex"f8718080a0df6daadb808cebc640643e94538dae83d15cd5154bf7338960b758c8ec6f1f2e8080808080a0edb51705685fa2adc2b9aff6671fb5ef50960e2576a5f9b518a2afff17d054e480a07ba9c58fa18549854d98b3a1f7403ecdaf930c725773dc3d8e4705b80523bdeb808080808080";
        proofs[charlie][4] =
            hex"ec9f20c7e46b9229ee478e04da93466bc9588a23ba2d51453e79a046c4018444908b8a6600e4bed9f8356dc4a1";

        box.addReward(rewardsToDistribute, merkleRoot, blockNumber, 0, totalStakedBalance);

        vm.prank(alice);
        vm.expectRevert();
        box.claim(blockNumber, proofs[alice]);
        
        vm.prank(bob);
        vm.expectRevert();
        box.claim(blockNumber, proofs[bob]);

        vm.prank(charlie);
        vm.expectRevert();
        box.claim(blockNumber, proofs[charlie]);
    }

    function testMerkleClaimWrongUserReverts() public {
        bytes32 merkleRoot = 0xbb7d7382954849916f37091ddbb5add6d492078386eb2665d3fa834305c895a5;
        uint256 blockNumber = 108080039;
        uint256 totalStakedBalance = 10065976484417347667174646;
        uint256 rewardsToDistribute = 1_000_000  * 1e18; // e.g. 1,000,000 SONNE

        // Alice
        proofs[alice] = new bytes[](5);
        proofs[alice][0] =
            hex"f90211a08abd3bf0735f6c8af16b465c444641c4a4ce26a6ccb10b590eae1019ca6d91bea0a9b5dd537be664137b662a77c373714676f4083f7ad4d9ac5039d12bfbf5bf2ea0fe64994de8dcb6ee57ed536f76615cdfe5715cfe6c4c3d9d3672f9e50a906575a0788b6efd7d68a2e10de135d0d30a428b4cc48c8c0091bc6839c69f88a275fc0ba002a76ef963d5b7dac1a5203f7c21f95edb19116c598f617b164922557fe7fcfba0e2cf31c1453885eb0fea89990b965c98f6c87a990e3a781df014ff3b13abe782a0afab23c0e37eb0486d9a967737eaca36f11b64cad00415ba397336811cb5f1c1a0be4341e706c7253078250713f61928a258d1d1e8603d9549eebea97c35ec1370a04315d3979e23e56c31185b5ceab1837df84aa2b429015470e070ad26767291f4a04375376e8361af86f013615dd42ecf459165155cffaaea9db11cdba2034f87b8a06d14c99f2e7443722c789ccd1515ea3881be2450a4a998855111dbaf34b20ae9a01db567b050a6ff3b76a5b3eaf94dc25355e62204db658fbe452f8ab2342fd2aca0c62d202f910310df3ea4160682c668b0b3a311f512c281f16eda7b8c22718d10a0db1406019172879c8967003ab11be60bc817bdf6de46f7d66ed6b8c9465b74dda070656f49d5fdbc42816e002cb75d777e2d37d7c3a8cf65cae138a5ea4c743114a066fb69cc78267a40a8b2e3f3205228c35479068f7ab29fa11279852fa8ae074980";
        proofs[alice][1] =
            hex"f90211a047db99358cb37ae0938f09a1e16786c361c3b3c9c43884e460f76ba2ac53eb0ea0bade11c065afb364417e1527517b849301ac8377311db25a0180274718d859dca0c2e8d820500faa647febe228cbeb88e01cce1e93c976f6e44a275f478100e331a05f67de958a47dace123e30f426117357b66e94932dd58abe4030b31651b75e12a0f63ef2fff6404143b8c2b8ff2585ba0bdc2aa1a36d695d9d80d197665ad2317ba0b9c9304e8f3651c9507d111ac2cf887636c845e9049094dc7beed44f3b8fcfbca0dcffef62a0a776b95d90fc3ac1875881fb02dd1e9d5524433891cb2058c9f67ba0a25cba82b7c1f56389b20b68d290426022449aedd9bf8bc6dc7470c1dcd68775a049697b357d6a9f4386cf76fde1e1bc7447392486593d23e43019007055d93cb8a00c401f8142b410da82fc3ae86498b71a39de6ba4ee101a3538a5d6a851fd515ea02f0ad57be386dc119e3b92d629f03f537db644674b91389aa9558f73d1bf1fb7a0daa5505c26a279b8ef07237b510cf6bcf01f63bdffcfeb6e36fd3e1a02cdc850a05953d5ba6ee7e9d1e2dcca261882ab36bf1835de80ae7e6aa79bcb2fdfee9b20a0c65cfef74c901cf85c42c57fdbb7c54a14179e90c0d219fc5be579a9a55e56eda04f90b2da3d6fd331d0c560ae3503197792f6888465bf26a6e75cdca6eb8246b6a0dd6294bd7b4756a370151f772c711a8ad4c3db674704e40b95eee073ee94648980";
        proofs[alice][2] =
            hex"f90191a076d51a3b3db08f41066db327988d44d6ddf3c56cede3d779665fac805f83102580a0f575edba68e1fe7af5a4114e7bf018ffaad2299a50e93d045bf63948c672e0aca002e55b1f036469e089e2540e96b32b6705ce2daeb501b3635b0ff2f4034f3c4d8080a0265bd08a6145dea879320e7cbe9f324d7b8f60c9f437102fa6f1c59db053928ca0989b9cc1a561266218fadb81efe2c09da5b3ebd1cee7f1e6d040813340f6f7caa0e676c11dc59dd2bf86087a4d0361f7d4c6da8b88d59f19c8e30baed1ffa59e41a0d65aef482da5d8aec552b1d4dc3c0da524417cee708bef5fe55df8f4cb0c58ef80a04a09f1f198af358646e90736eb69231fca3ed2640d669792c77d1c28bad66c67a0ee35f0573a1436e25462729aa6053c9aa202708119ab0822fa338e92f84b574aa012e53738e09238f2bf225b636a321256ce62112014719952a905b5f32829d1eba01b0aed7e549bf4ea3fd6458aedf9acfab5710c35f879103a51389fa30cbba60fa07be7c88782b9f205adebe80484b36ada7cb23ad4a8d93feba2823ff3c8c5e0ac80";
        proofs[alice][3] =
            hex"f851a05927a5f106de9e816bba621350ecefdcb3bad1832718128a1243646a9de0a5b88080808080808080808080a0499280066e6025305c59d623a6235b822915170b1fd835da9d45edff90f0f82680808080";
        proofs[alice][4] =
            hex"ec9f208b8f70e5ac7d4318dffb52f0e48050e1c9db919a29eabde8f3cd496b7a778b8a40348143698d45800000";

        // Bob
        proofs[bob] = new bytes[](5);
        proofs[bob][0] =
            hex"f90211a08abd3bf0735f6c8af16b465c444641c4a4ce26a6ccb10b590eae1019ca6d91bea0a9b5dd537be664137b662a77c373714676f4083f7ad4d9ac5039d12bfbf5bf2ea0fe64994de8dcb6ee57ed536f76615cdfe5715cfe6c4c3d9d3672f9e50a906575a0788b6efd7d68a2e10de135d0d30a428b4cc48c8c0091bc6839c69f88a275fc0ba002a76ef963d5b7dac1a5203f7c21f95edb19116c598f617b164922557fe7fcfba0e2cf31c1453885eb0fea89990b965c98f6c87a990e3a781df014ff3b13abe782a0afab23c0e37eb0486d9a967737eaca36f11b64cad00415ba397336811cb5f1c1a0be4341e706c7253078250713f61928a258d1d1e8603d9549eebea97c35ec1370a04315d3979e23e56c31185b5ceab1837df84aa2b429015470e070ad26767291f4a04375376e8361af86f013615dd42ecf459165155cffaaea9db11cdba2034f87b8a06d14c99f2e7443722c789ccd1515ea3881be2450a4a998855111dbaf34b20ae9a01db567b050a6ff3b76a5b3eaf94dc25355e62204db658fbe452f8ab2342fd2aca0c62d202f910310df3ea4160682c668b0b3a311f512c281f16eda7b8c22718d10a0db1406019172879c8967003ab11be60bc817bdf6de46f7d66ed6b8c9465b74dda070656f49d5fdbc42816e002cb75d777e2d37d7c3a8cf65cae138a5ea4c743114a066fb69cc78267a40a8b2e3f3205228c35479068f7ab29fa11279852fa8ae074980";
        proofs[bob][1] =
            hex"f90211a035a61b32334ff1db83ba353ce7dea0655b68d4565e0ca4b645868168c7169932a0f0d74db2c58a7c797abeedf0e5307ef159ad4bc1a2cf8237da8f5e7f73b674a7a02215fc8e414530c7af15e80fb5eb58b9d77c3dfd02e7cb341451aed0c53194a9a0ef21029cb9f4f5f0f642f1d1874a765a968c746fca4dcca93555b71de293c920a065b9e203ea0febc5a2c267492665a2fa2b07698bf0afe263feb7c0e4e56e4a88a0bd500854b6deb150a6c9e7d9735df6e104442595e60750432245508c723f8473a08fb4b814dda000ceba20d9ea2b0da1a6e317a3a6305f2a938a6c68937f063571a05ce7ee750a17d11695347b93bc6982c7254a58b712a8e5ea0cdcb1d640c301f0a06d8deb65cfeac289d05afa4d67e1e41e8d0f21db29c9842fa11712783f76f961a08c679ee7d43ee9fd332a154d85b4633130ab30243ae0d82f2436508d24465ffca090ab4ad2718c0a808693b1641d558ba1220058cf692028626cc5552e33c2abaaa06d748a75c8cecd77eabd1c760c5d0fba460fd374c07c4dc90be824d0319466aaa0741e7bd9630617d50dc550ed43ee55c67d0167846c551882099b055645eb9165a02c026bfb03c046c039b46254468b819101c9ddbc3371d6b4a5fd7cf76c5e5752a09dbbbc6c51ef954ed3e01f13dd2e4339b6cc53a77b068085804c955a8f13806aa039dbbbcdd8b8bb8a74a1314411fef608977f247bb9842fb18b0f095bb59cb02f80";
        proofs[bob][2] =
            hex"f90171a0a9add3527e1a412b4090f9e99891791f58886d9e1f196cd4e332350de3316beca07a1d42f1091a7d1149d5f92134aff178e2e8a496249447b2a64d7f69bae2c93ba0f927578899d52766cda6efbd2af44be57bcbdacd0c95cc8bec06f776117a8c6380a0364abca82e680a9c42971e08e72caa9a3ff9f2d700a066b72935fa6d8f9279b6a0a7dc31fdd3ac4b46ca4010fa37a34e04468ad3c20120a3a7e60dd95ba5ab56c8a02dacd128f54d9311db4cbfe8d01b56d4921cf265b938b2f38e3c8942400d7c1ea0c659cc93f0fb26484d1998355fdeacf106a39ab08eed4f80fb2c3b31be9ff988a0a660a4e865e190d91101691f22b2000af98169f1e6a12faf61d30ca6a1534171a029cc1010ec11de701af6c0d80213325429bb5ae51ae63e1d7515b4861c251eefa032ee88e4431c84101751b98e8c7b155fb970715fa9f1968efa28873e14a303f98080a0099be9346755a2855229cd3f76e4af5455aa896d659a3135c48fdc5eb737e7ae808080";
        proofs[bob][3] =
            hex"f87180a09500bed5f69925e8e56b5eca5fd401d2bcea75345714463e2e60a98bb07a7c7c80a0ad1a1d6bc4386230802b5458a215ea265015d3f66d493b9670be435617f4a49a808080808080a04719db31c9528548dd84a965c46b48f8816c6dd6169f546b640e3ed4f9fd34e6808080808080";
        proofs[bob][4] = hex"ec9f200f23e9eeb794cd6b8f3944813b838b1099508a8f733f35e63e6d979a93c58b8a055888c0d241f0540000";

        // Charlie
        proofs[charlie] = new bytes[](5);
        proofs[charlie][0] =
            hex"f90211a08abd3bf0735f6c8af16b465c444641c4a4ce26a6ccb10b590eae1019ca6d91bea0a9b5dd537be664137b662a77c373714676f4083f7ad4d9ac5039d12bfbf5bf2ea0fe64994de8dcb6ee57ed536f76615cdfe5715cfe6c4c3d9d3672f9e50a906575a0788b6efd7d68a2e10de135d0d30a428b4cc48c8c0091bc6839c69f88a275fc0ba002a76ef963d5b7dac1a5203f7c21f95edb19116c598f617b164922557fe7fcfba0e2cf31c1453885eb0fea89990b965c98f6c87a990e3a781df014ff3b13abe782a0afab23c0e37eb0486d9a967737eaca36f11b64cad00415ba397336811cb5f1c1a0be4341e706c7253078250713f61928a258d1d1e8603d9549eebea97c35ec1370a04315d3979e23e56c31185b5ceab1837df84aa2b429015470e070ad26767291f4a04375376e8361af86f013615dd42ecf459165155cffaaea9db11cdba2034f87b8a06d14c99f2e7443722c789ccd1515ea3881be2450a4a998855111dbaf34b20ae9a01db567b050a6ff3b76a5b3eaf94dc25355e62204db658fbe452f8ab2342fd2aca0c62d202f910310df3ea4160682c668b0b3a311f512c281f16eda7b8c22718d10a0db1406019172879c8967003ab11be60bc817bdf6de46f7d66ed6b8c9465b74dda070656f49d5fdbc42816e002cb75d777e2d37d7c3a8cf65cae138a5ea4c743114a066fb69cc78267a40a8b2e3f3205228c35479068f7ab29fa11279852fa8ae074980";
        proofs[charlie][1] =
            hex"f90211a035a61b32334ff1db83ba353ce7dea0655b68d4565e0ca4b645868168c7169932a0f0d74db2c58a7c797abeedf0e5307ef159ad4bc1a2cf8237da8f5e7f73b674a7a02215fc8e414530c7af15e80fb5eb58b9d77c3dfd02e7cb341451aed0c53194a9a0ef21029cb9f4f5f0f642f1d1874a765a968c746fca4dcca93555b71de293c920a065b9e203ea0febc5a2c267492665a2fa2b07698bf0afe263feb7c0e4e56e4a88a0bd500854b6deb150a6c9e7d9735df6e104442595e60750432245508c723f8473a08fb4b814dda000ceba20d9ea2b0da1a6e317a3a6305f2a938a6c68937f063571a05ce7ee750a17d11695347b93bc6982c7254a58b712a8e5ea0cdcb1d640c301f0a06d8deb65cfeac289d05afa4d67e1e41e8d0f21db29c9842fa11712783f76f961a08c679ee7d43ee9fd332a154d85b4633130ab30243ae0d82f2436508d24465ffca090ab4ad2718c0a808693b1641d558ba1220058cf692028626cc5552e33c2abaaa06d748a75c8cecd77eabd1c760c5d0fba460fd374c07c4dc90be824d0319466aaa0741e7bd9630617d50dc550ed43ee55c67d0167846c551882099b055645eb9165a02c026bfb03c046c039b46254468b819101c9ddbc3371d6b4a5fd7cf76c5e5752a09dbbbc6c51ef954ed3e01f13dd2e4339b6cc53a77b068085804c955a8f13806aa039dbbbcdd8b8bb8a74a1314411fef608977f247bb9842fb18b0f095bb59cb02f80";
        proofs[charlie][2] =
            hex"f90151a077d45ed2eab47946b1642df26da6fe34adf83cb72612813de5686ebfd6e5a6a0a06a8100cefd6a1ee7e5a51e18370335e33a99c77b4b87a85f2173d9d39536445da0a7e3960f00ec6759924bf28395d55271fc8b4a4e0e9ddc6772ae7da769f0032ea0646be174586a3e45e368056e73d83d0a4125b42aaf989a174116e3e40675706d80a072330cac43f1642b8ad0c260c7d987d4d15d79e4b5bba6e9a21b651190b2234da01c5e5607c09079e32f1475514cc66a12b8a11e66aa1fad40e8366a7ee750cf1aa0a16038d6e305cb9e5be8a9e5dd3ec446738dd84fd54e8d5d840c41fd94d9619980808080a0568ac643819e5f5da88303cb599aa3f4eef49dcb632e833f0516fcdd97dd179080a088061e5b61ff03e482f75f80152e8c2c184213eafba35123fcf9e90297fda7cea0cbbce5379ddd15d05dafcf654213649378db1a1a889bf949b01aa3851ee8022880";
        proofs[charlie][3] =
            hex"f8718080a0df6daadb808cebc640643e94538dae83d15cd5154bf7338960b758c8ec6f1f2e8080808080a0edb51705685fa2adc2b9aff6671fb5ef50960e2576a5f9b518a2afff17d054e480a07ba9c58fa18549854d98b3a1f7403ecdaf930c725773dc3d8e4705b80523bdeb808080808080";
        proofs[charlie][4] =
            hex"ec9f20c7e46b9229ee478e04da93466bc9588a23ba2d51453e79a046c4018444908b8a6600e4bed9f8356dc4a1";

        box.addReward(rewardsToDistribute, merkleRoot, blockNumber, 0, totalStakedBalance);

        // Alice tries to withdraw Bob's portion, should revert
        vm.expectRevert();
        box.claim(blockNumber, proofs[bob]);
        
    }

    function testDoubleClaimReverts() public {
        bytes32 merkleRoot = 0xbb7d7382954849916f37091ddbb5add6d492078386eb2665d3fa834305c895a5;
        uint256 blockNumber = 108080039;
        uint256 totalStakedBalance = 10065976484417347667174646;
        uint256 rewardsToDistribute = 1_000_000  * 1e18; // e.g. 1,000,000 SONNE

        // Alice
        proofs[alice] = new bytes[](5);
        proofs[alice][0] =
            hex"f90211a08abd3bf0735f6c8af16b465c444641c4a4ce26a6ccb10b590eae1019ca6d91bea0a9b5dd537be664137b662a77c373714676f4083f7ad4d9ac5039d12bfbf5bf2ea0fe64994de8dcb6ee57ed536f76615cdfe5715cfe6c4c3d9d3672f9e50a906575a0788b6efd7d68a2e10de135d0d30a428b4cc48c8c0091bc6839c69f88a275fc0ba002a76ef963d5b7dac1a5203f7c21f95edb19116c598f617b164922557fe7fcfba0e2cf31c1453885eb0fea89990b965c98f6c87a990e3a781df014ff3b13abe782a0afab23c0e37eb0486d9a967737eaca36f11b64cad00415ba397336811cb5f1c1a0be4341e706c7253078250713f61928a258d1d1e8603d9549eebea97c35ec1370a04315d3979e23e56c31185b5ceab1837df84aa2b429015470e070ad26767291f4a04375376e8361af86f013615dd42ecf459165155cffaaea9db11cdba2034f87b8a06d14c99f2e7443722c789ccd1515ea3881be2450a4a998855111dbaf34b20ae9a01db567b050a6ff3b76a5b3eaf94dc25355e62204db658fbe452f8ab2342fd2aca0c62d202f910310df3ea4160682c668b0b3a311f512c281f16eda7b8c22718d10a0db1406019172879c8967003ab11be60bc817bdf6de46f7d66ed6b8c9465b74dda070656f49d5fdbc42816e002cb75d777e2d37d7c3a8cf65cae138a5ea4c743114a066fb69cc78267a40a8b2e3f3205228c35479068f7ab29fa11279852fa8ae074980";
        proofs[alice][1] =
            hex"f90211a047db99358cb37ae0938f09a1e16786c361c3b3c9c43884e460f76ba2ac53eb0ea0bade11c065afb364417e1527517b849301ac8377311db25a0180274718d859dca0c2e8d820500faa647febe228cbeb88e01cce1e93c976f6e44a275f478100e331a05f67de958a47dace123e30f426117357b66e94932dd58abe4030b31651b75e12a0f63ef2fff6404143b8c2b8ff2585ba0bdc2aa1a36d695d9d80d197665ad2317ba0b9c9304e8f3651c9507d111ac2cf887636c845e9049094dc7beed44f3b8fcfbca0dcffef62a0a776b95d90fc3ac1875881fb02dd1e9d5524433891cb2058c9f67ba0a25cba82b7c1f56389b20b68d290426022449aedd9bf8bc6dc7470c1dcd68775a049697b357d6a9f4386cf76fde1e1bc7447392486593d23e43019007055d93cb8a00c401f8142b410da82fc3ae86498b71a39de6ba4ee101a3538a5d6a851fd515ea02f0ad57be386dc119e3b92d629f03f537db644674b91389aa9558f73d1bf1fb7a0daa5505c26a279b8ef07237b510cf6bcf01f63bdffcfeb6e36fd3e1a02cdc850a05953d5ba6ee7e9d1e2dcca261882ab36bf1835de80ae7e6aa79bcb2fdfee9b20a0c65cfef74c901cf85c42c57fdbb7c54a14179e90c0d219fc5be579a9a55e56eda04f90b2da3d6fd331d0c560ae3503197792f6888465bf26a6e75cdca6eb8246b6a0dd6294bd7b4756a370151f772c711a8ad4c3db674704e40b95eee073ee94648980";
        proofs[alice][2] =
            hex"f90191a076d51a3b3db08f41066db327988d44d6ddf3c56cede3d779665fac805f83102580a0f575edba68e1fe7af5a4114e7bf018ffaad2299a50e93d045bf63948c672e0aca002e55b1f036469e089e2540e96b32b6705ce2daeb501b3635b0ff2f4034f3c4d8080a0265bd08a6145dea879320e7cbe9f324d7b8f60c9f437102fa6f1c59db053928ca0989b9cc1a561266218fadb81efe2c09da5b3ebd1cee7f1e6d040813340f6f7caa0e676c11dc59dd2bf86087a4d0361f7d4c6da8b88d59f19c8e30baed1ffa59e41a0d65aef482da5d8aec552b1d4dc3c0da524417cee708bef5fe55df8f4cb0c58ef80a04a09f1f198af358646e90736eb69231fca3ed2640d669792c77d1c28bad66c67a0ee35f0573a1436e25462729aa6053c9aa202708119ab0822fa338e92f84b574aa012e53738e09238f2bf225b636a321256ce62112014719952a905b5f32829d1eba01b0aed7e549bf4ea3fd6458aedf9acfab5710c35f879103a51389fa30cbba60fa07be7c88782b9f205adebe80484b36ada7cb23ad4a8d93feba2823ff3c8c5e0ac80";
        proofs[alice][3] =
            hex"f851a05927a5f106de9e816bba621350ecefdcb3bad1832718128a1243646a9de0a5b88080808080808080808080a0499280066e6025305c59d623a6235b822915170b1fd835da9d45edff90f0f82680808080";
        proofs[alice][4] =
            hex"ec9f208b8f70e5ac7d4318dffb52f0e48050e1c9db919a29eabde8f3cd496b7a778b8a40348143698d45800000";

        // Bob
        proofs[bob] = new bytes[](5);
        proofs[bob][0] =
            hex"f90211a08abd3bf0735f6c8af16b465c444641c4a4ce26a6ccb10b590eae1019ca6d91bea0a9b5dd537be664137b662a77c373714676f4083f7ad4d9ac5039d12bfbf5bf2ea0fe64994de8dcb6ee57ed536f76615cdfe5715cfe6c4c3d9d3672f9e50a906575a0788b6efd7d68a2e10de135d0d30a428b4cc48c8c0091bc6839c69f88a275fc0ba002a76ef963d5b7dac1a5203f7c21f95edb19116c598f617b164922557fe7fcfba0e2cf31c1453885eb0fea89990b965c98f6c87a990e3a781df014ff3b13abe782a0afab23c0e37eb0486d9a967737eaca36f11b64cad00415ba397336811cb5f1c1a0be4341e706c7253078250713f61928a258d1d1e8603d9549eebea97c35ec1370a04315d3979e23e56c31185b5ceab1837df84aa2b429015470e070ad26767291f4a04375376e8361af86f013615dd42ecf459165155cffaaea9db11cdba2034f87b8a06d14c99f2e7443722c789ccd1515ea3881be2450a4a998855111dbaf34b20ae9a01db567b050a6ff3b76a5b3eaf94dc25355e62204db658fbe452f8ab2342fd2aca0c62d202f910310df3ea4160682c668b0b3a311f512c281f16eda7b8c22718d10a0db1406019172879c8967003ab11be60bc817bdf6de46f7d66ed6b8c9465b74dda070656f49d5fdbc42816e002cb75d777e2d37d7c3a8cf65cae138a5ea4c743114a066fb69cc78267a40a8b2e3f3205228c35479068f7ab29fa11279852fa8ae074980";
        proofs[bob][1] =
            hex"f90211a035a61b32334ff1db83ba353ce7dea0655b68d4565e0ca4b645868168c7169932a0f0d74db2c58a7c797abeedf0e5307ef159ad4bc1a2cf8237da8f5e7f73b674a7a02215fc8e414530c7af15e80fb5eb58b9d77c3dfd02e7cb341451aed0c53194a9a0ef21029cb9f4f5f0f642f1d1874a765a968c746fca4dcca93555b71de293c920a065b9e203ea0febc5a2c267492665a2fa2b07698bf0afe263feb7c0e4e56e4a88a0bd500854b6deb150a6c9e7d9735df6e104442595e60750432245508c723f8473a08fb4b814dda000ceba20d9ea2b0da1a6e317a3a6305f2a938a6c68937f063571a05ce7ee750a17d11695347b93bc6982c7254a58b712a8e5ea0cdcb1d640c301f0a06d8deb65cfeac289d05afa4d67e1e41e8d0f21db29c9842fa11712783f76f961a08c679ee7d43ee9fd332a154d85b4633130ab30243ae0d82f2436508d24465ffca090ab4ad2718c0a808693b1641d558ba1220058cf692028626cc5552e33c2abaaa06d748a75c8cecd77eabd1c760c5d0fba460fd374c07c4dc90be824d0319466aaa0741e7bd9630617d50dc550ed43ee55c67d0167846c551882099b055645eb9165a02c026bfb03c046c039b46254468b819101c9ddbc3371d6b4a5fd7cf76c5e5752a09dbbbc6c51ef954ed3e01f13dd2e4339b6cc53a77b068085804c955a8f13806aa039dbbbcdd8b8bb8a74a1314411fef608977f247bb9842fb18b0f095bb59cb02f80";
        proofs[bob][2] =
            hex"f90171a0a9add3527e1a412b4090f9e99891791f58886d9e1f196cd4e332350de3316beca07a1d42f1091a7d1149d5f92134aff178e2e8a496249447b2a64d7f69bae2c93ba0f927578899d52766cda6efbd2af44be57bcbdacd0c95cc8bec06f776117a8c6380a0364abca82e680a9c42971e08e72caa9a3ff9f2d700a066b72935fa6d8f9279b6a0a7dc31fdd3ac4b46ca4010fa37a34e04468ad3c20120a3a7e60dd95ba5ab56c8a02dacd128f54d9311db4cbfe8d01b56d4921cf265b938b2f38e3c8942400d7c1ea0c659cc93f0fb26484d1998355fdeacf106a39ab08eed4f80fb2c3b31be9ff988a0a660a4e865e190d91101691f22b2000af98169f1e6a12faf61d30ca6a1534171a029cc1010ec11de701af6c0d80213325429bb5ae51ae63e1d7515b4861c251eefa032ee88e4431c84101751b98e8c7b155fb970715fa9f1968efa28873e14a303f98080a0099be9346755a2855229cd3f76e4af5455aa896d659a3135c48fdc5eb737e7ae808080";
        proofs[bob][3] =
            hex"f87180a09500bed5f69925e8e56b5eca5fd401d2bcea75345714463e2e60a98bb07a7c7c80a0ad1a1d6bc4386230802b5458a215ea265015d3f66d493b9670be435617f4a49a808080808080a04719db31c9528548dd84a965c46b48f8816c6dd6169f546b640e3ed4f9fd34e6808080808080";
        proofs[bob][4] = hex"ec9f200f23e9eeb794cd6b8f3944813b838b1099508a8f733f35e63e6d979a93c58b8a055888c0d241f0540000";

        // Charlie
        proofs[charlie] = new bytes[](5);
        proofs[charlie][0] =
            hex"f90211a08abd3bf0735f6c8af16b465c444641c4a4ce26a6ccb10b590eae1019ca6d91bea0a9b5dd537be664137b662a77c373714676f4083f7ad4d9ac5039d12bfbf5bf2ea0fe64994de8dcb6ee57ed536f76615cdfe5715cfe6c4c3d9d3672f9e50a906575a0788b6efd7d68a2e10de135d0d30a428b4cc48c8c0091bc6839c69f88a275fc0ba002a76ef963d5b7dac1a5203f7c21f95edb19116c598f617b164922557fe7fcfba0e2cf31c1453885eb0fea89990b965c98f6c87a990e3a781df014ff3b13abe782a0afab23c0e37eb0486d9a967737eaca36f11b64cad00415ba397336811cb5f1c1a0be4341e706c7253078250713f61928a258d1d1e8603d9549eebea97c35ec1370a04315d3979e23e56c31185b5ceab1837df84aa2b429015470e070ad26767291f4a04375376e8361af86f013615dd42ecf459165155cffaaea9db11cdba2034f87b8a06d14c99f2e7443722c789ccd1515ea3881be2450a4a998855111dbaf34b20ae9a01db567b050a6ff3b76a5b3eaf94dc25355e62204db658fbe452f8ab2342fd2aca0c62d202f910310df3ea4160682c668b0b3a311f512c281f16eda7b8c22718d10a0db1406019172879c8967003ab11be60bc817bdf6de46f7d66ed6b8c9465b74dda070656f49d5fdbc42816e002cb75d777e2d37d7c3a8cf65cae138a5ea4c743114a066fb69cc78267a40a8b2e3f3205228c35479068f7ab29fa11279852fa8ae074980";
        proofs[charlie][1] =
            hex"f90211a035a61b32334ff1db83ba353ce7dea0655b68d4565e0ca4b645868168c7169932a0f0d74db2c58a7c797abeedf0e5307ef159ad4bc1a2cf8237da8f5e7f73b674a7a02215fc8e414530c7af15e80fb5eb58b9d77c3dfd02e7cb341451aed0c53194a9a0ef21029cb9f4f5f0f642f1d1874a765a968c746fca4dcca93555b71de293c920a065b9e203ea0febc5a2c267492665a2fa2b07698bf0afe263feb7c0e4e56e4a88a0bd500854b6deb150a6c9e7d9735df6e104442595e60750432245508c723f8473a08fb4b814dda000ceba20d9ea2b0da1a6e317a3a6305f2a938a6c68937f063571a05ce7ee750a17d11695347b93bc6982c7254a58b712a8e5ea0cdcb1d640c301f0a06d8deb65cfeac289d05afa4d67e1e41e8d0f21db29c9842fa11712783f76f961a08c679ee7d43ee9fd332a154d85b4633130ab30243ae0d82f2436508d24465ffca090ab4ad2718c0a808693b1641d558ba1220058cf692028626cc5552e33c2abaaa06d748a75c8cecd77eabd1c760c5d0fba460fd374c07c4dc90be824d0319466aaa0741e7bd9630617d50dc550ed43ee55c67d0167846c551882099b055645eb9165a02c026bfb03c046c039b46254468b819101c9ddbc3371d6b4a5fd7cf76c5e5752a09dbbbc6c51ef954ed3e01f13dd2e4339b6cc53a77b068085804c955a8f13806aa039dbbbcdd8b8bb8a74a1314411fef608977f247bb9842fb18b0f095bb59cb02f80";
        proofs[charlie][2] =
            hex"f90151a077d45ed2eab47946b1642df26da6fe34adf83cb72612813de5686ebfd6e5a6a0a06a8100cefd6a1ee7e5a51e18370335e33a99c77b4b87a85f2173d9d39536445da0a7e3960f00ec6759924bf28395d55271fc8b4a4e0e9ddc6772ae7da769f0032ea0646be174586a3e45e368056e73d83d0a4125b42aaf989a174116e3e40675706d80a072330cac43f1642b8ad0c260c7d987d4d15d79e4b5bba6e9a21b651190b2234da01c5e5607c09079e32f1475514cc66a12b8a11e66aa1fad40e8366a7ee750cf1aa0a16038d6e305cb9e5be8a9e5dd3ec446738dd84fd54e8d5d840c41fd94d9619980808080a0568ac643819e5f5da88303cb599aa3f4eef49dcb632e833f0516fcdd97dd179080a088061e5b61ff03e482f75f80152e8c2c184213eafba35123fcf9e90297fda7cea0cbbce5379ddd15d05dafcf654213649378db1a1a889bf949b01aa3851ee8022880";
        proofs[charlie][3] =
            hex"f8718080a0df6daadb808cebc640643e94538dae83d15cd5154bf7338960b758c8ec6f1f2e8080808080a0edb51705685fa2adc2b9aff6671fb5ef50960e2576a5f9b518a2afff17d054e480a07ba9c58fa18549854d98b3a1f7403ecdaf930c725773dc3d8e4705b80523bdeb808080808080";
        proofs[charlie][4] =
            hex"ec9f20c7e46b9229ee478e04da93466bc9588a23ba2d51453e79a046c4018444908b8a6600e4bed9f8356dc4a1";

        box.addReward(rewardsToDistribute, merkleRoot, blockNumber, 0, totalStakedBalance);

        vm.prank(alice);
        box.claim(blockNumber, proofs[alice]);

        vm.expectRevert();
        box.claim(blockNumber, proofs[alice]);
    }

    function testClaimWithDelegation() public {
        bytes32 merkleRoot = 0xbb7d7382954849916f37091ddbb5add6d492078386eb2665d3fa834305c895a5;
        uint256 blockNumber = 108080039;
        uint256 totalStakedBalance = 10065976484417347667174646;
        uint256 rewardsToDistribute = 1_000_000  * 1e18; // e.g. 1,000,000 SONNE

        // Alice
        proofs[alice] = new bytes[](5);
        proofs[alice][0] =
            hex"f90211a08abd3bf0735f6c8af16b465c444641c4a4ce26a6ccb10b590eae1019ca6d91bea0a9b5dd537be664137b662a77c373714676f4083f7ad4d9ac5039d12bfbf5bf2ea0fe64994de8dcb6ee57ed536f76615cdfe5715cfe6c4c3d9d3672f9e50a906575a0788b6efd7d68a2e10de135d0d30a428b4cc48c8c0091bc6839c69f88a275fc0ba002a76ef963d5b7dac1a5203f7c21f95edb19116c598f617b164922557fe7fcfba0e2cf31c1453885eb0fea89990b965c98f6c87a990e3a781df014ff3b13abe782a0afab23c0e37eb0486d9a967737eaca36f11b64cad00415ba397336811cb5f1c1a0be4341e706c7253078250713f61928a258d1d1e8603d9549eebea97c35ec1370a04315d3979e23e56c31185b5ceab1837df84aa2b429015470e070ad26767291f4a04375376e8361af86f013615dd42ecf459165155cffaaea9db11cdba2034f87b8a06d14c99f2e7443722c789ccd1515ea3881be2450a4a998855111dbaf34b20ae9a01db567b050a6ff3b76a5b3eaf94dc25355e62204db658fbe452f8ab2342fd2aca0c62d202f910310df3ea4160682c668b0b3a311f512c281f16eda7b8c22718d10a0db1406019172879c8967003ab11be60bc817bdf6de46f7d66ed6b8c9465b74dda070656f49d5fdbc42816e002cb75d777e2d37d7c3a8cf65cae138a5ea4c743114a066fb69cc78267a40a8b2e3f3205228c35479068f7ab29fa11279852fa8ae074980";
        proofs[alice][1] =
            hex"f90211a047db99358cb37ae0938f09a1e16786c361c3b3c9c43884e460f76ba2ac53eb0ea0bade11c065afb364417e1527517b849301ac8377311db25a0180274718d859dca0c2e8d820500faa647febe228cbeb88e01cce1e93c976f6e44a275f478100e331a05f67de958a47dace123e30f426117357b66e94932dd58abe4030b31651b75e12a0f63ef2fff6404143b8c2b8ff2585ba0bdc2aa1a36d695d9d80d197665ad2317ba0b9c9304e8f3651c9507d111ac2cf887636c845e9049094dc7beed44f3b8fcfbca0dcffef62a0a776b95d90fc3ac1875881fb02dd1e9d5524433891cb2058c9f67ba0a25cba82b7c1f56389b20b68d290426022449aedd9bf8bc6dc7470c1dcd68775a049697b357d6a9f4386cf76fde1e1bc7447392486593d23e43019007055d93cb8a00c401f8142b410da82fc3ae86498b71a39de6ba4ee101a3538a5d6a851fd515ea02f0ad57be386dc119e3b92d629f03f537db644674b91389aa9558f73d1bf1fb7a0daa5505c26a279b8ef07237b510cf6bcf01f63bdffcfeb6e36fd3e1a02cdc850a05953d5ba6ee7e9d1e2dcca261882ab36bf1835de80ae7e6aa79bcb2fdfee9b20a0c65cfef74c901cf85c42c57fdbb7c54a14179e90c0d219fc5be579a9a55e56eda04f90b2da3d6fd331d0c560ae3503197792f6888465bf26a6e75cdca6eb8246b6a0dd6294bd7b4756a370151f772c711a8ad4c3db674704e40b95eee073ee94648980";
        proofs[alice][2] =
            hex"f90191a076d51a3b3db08f41066db327988d44d6ddf3c56cede3d779665fac805f83102580a0f575edba68e1fe7af5a4114e7bf018ffaad2299a50e93d045bf63948c672e0aca002e55b1f036469e089e2540e96b32b6705ce2daeb501b3635b0ff2f4034f3c4d8080a0265bd08a6145dea879320e7cbe9f324d7b8f60c9f437102fa6f1c59db053928ca0989b9cc1a561266218fadb81efe2c09da5b3ebd1cee7f1e6d040813340f6f7caa0e676c11dc59dd2bf86087a4d0361f7d4c6da8b88d59f19c8e30baed1ffa59e41a0d65aef482da5d8aec552b1d4dc3c0da524417cee708bef5fe55df8f4cb0c58ef80a04a09f1f198af358646e90736eb69231fca3ed2640d669792c77d1c28bad66c67a0ee35f0573a1436e25462729aa6053c9aa202708119ab0822fa338e92f84b574aa012e53738e09238f2bf225b636a321256ce62112014719952a905b5f32829d1eba01b0aed7e549bf4ea3fd6458aedf9acfab5710c35f879103a51389fa30cbba60fa07be7c88782b9f205adebe80484b36ada7cb23ad4a8d93feba2823ff3c8c5e0ac80";
        proofs[alice][3] =
            hex"f851a05927a5f106de9e816bba621350ecefdcb3bad1832718128a1243646a9de0a5b88080808080808080808080a0499280066e6025305c59d623a6235b822915170b1fd835da9d45edff90f0f82680808080";
        proofs[alice][4] =
            hex"ec9f208b8f70e5ac7d4318dffb52f0e48050e1c9db919a29eabde8f3cd496b7a778b8a40348143698d45800000";

        // Bob
        proofs[bob] = new bytes[](5);
        proofs[bob][0] =
            hex"f90211a08abd3bf0735f6c8af16b465c444641c4a4ce26a6ccb10b590eae1019ca6d91bea0a9b5dd537be664137b662a77c373714676f4083f7ad4d9ac5039d12bfbf5bf2ea0fe64994de8dcb6ee57ed536f76615cdfe5715cfe6c4c3d9d3672f9e50a906575a0788b6efd7d68a2e10de135d0d30a428b4cc48c8c0091bc6839c69f88a275fc0ba002a76ef963d5b7dac1a5203f7c21f95edb19116c598f617b164922557fe7fcfba0e2cf31c1453885eb0fea89990b965c98f6c87a990e3a781df014ff3b13abe782a0afab23c0e37eb0486d9a967737eaca36f11b64cad00415ba397336811cb5f1c1a0be4341e706c7253078250713f61928a258d1d1e8603d9549eebea97c35ec1370a04315d3979e23e56c31185b5ceab1837df84aa2b429015470e070ad26767291f4a04375376e8361af86f013615dd42ecf459165155cffaaea9db11cdba2034f87b8a06d14c99f2e7443722c789ccd1515ea3881be2450a4a998855111dbaf34b20ae9a01db567b050a6ff3b76a5b3eaf94dc25355e62204db658fbe452f8ab2342fd2aca0c62d202f910310df3ea4160682c668b0b3a311f512c281f16eda7b8c22718d10a0db1406019172879c8967003ab11be60bc817bdf6de46f7d66ed6b8c9465b74dda070656f49d5fdbc42816e002cb75d777e2d37d7c3a8cf65cae138a5ea4c743114a066fb69cc78267a40a8b2e3f3205228c35479068f7ab29fa11279852fa8ae074980";
        proofs[bob][1] =
            hex"f90211a035a61b32334ff1db83ba353ce7dea0655b68d4565e0ca4b645868168c7169932a0f0d74db2c58a7c797abeedf0e5307ef159ad4bc1a2cf8237da8f5e7f73b674a7a02215fc8e414530c7af15e80fb5eb58b9d77c3dfd02e7cb341451aed0c53194a9a0ef21029cb9f4f5f0f642f1d1874a765a968c746fca4dcca93555b71de293c920a065b9e203ea0febc5a2c267492665a2fa2b07698bf0afe263feb7c0e4e56e4a88a0bd500854b6deb150a6c9e7d9735df6e104442595e60750432245508c723f8473a08fb4b814dda000ceba20d9ea2b0da1a6e317a3a6305f2a938a6c68937f063571a05ce7ee750a17d11695347b93bc6982c7254a58b712a8e5ea0cdcb1d640c301f0a06d8deb65cfeac289d05afa4d67e1e41e8d0f21db29c9842fa11712783f76f961a08c679ee7d43ee9fd332a154d85b4633130ab30243ae0d82f2436508d24465ffca090ab4ad2718c0a808693b1641d558ba1220058cf692028626cc5552e33c2abaaa06d748a75c8cecd77eabd1c760c5d0fba460fd374c07c4dc90be824d0319466aaa0741e7bd9630617d50dc550ed43ee55c67d0167846c551882099b055645eb9165a02c026bfb03c046c039b46254468b819101c9ddbc3371d6b4a5fd7cf76c5e5752a09dbbbc6c51ef954ed3e01f13dd2e4339b6cc53a77b068085804c955a8f13806aa039dbbbcdd8b8bb8a74a1314411fef608977f247bb9842fb18b0f095bb59cb02f80";
        proofs[bob][2] =
            hex"f90171a0a9add3527e1a412b4090f9e99891791f58886d9e1f196cd4e332350de3316beca07a1d42f1091a7d1149d5f92134aff178e2e8a496249447b2a64d7f69bae2c93ba0f927578899d52766cda6efbd2af44be57bcbdacd0c95cc8bec06f776117a8c6380a0364abca82e680a9c42971e08e72caa9a3ff9f2d700a066b72935fa6d8f9279b6a0a7dc31fdd3ac4b46ca4010fa37a34e04468ad3c20120a3a7e60dd95ba5ab56c8a02dacd128f54d9311db4cbfe8d01b56d4921cf265b938b2f38e3c8942400d7c1ea0c659cc93f0fb26484d1998355fdeacf106a39ab08eed4f80fb2c3b31be9ff988a0a660a4e865e190d91101691f22b2000af98169f1e6a12faf61d30ca6a1534171a029cc1010ec11de701af6c0d80213325429bb5ae51ae63e1d7515b4861c251eefa032ee88e4431c84101751b98e8c7b155fb970715fa9f1968efa28873e14a303f98080a0099be9346755a2855229cd3f76e4af5455aa896d659a3135c48fdc5eb737e7ae808080";
        proofs[bob][3] =
            hex"f87180a09500bed5f69925e8e56b5eca5fd401d2bcea75345714463e2e60a98bb07a7c7c80a0ad1a1d6bc4386230802b5458a215ea265015d3f66d493b9670be435617f4a49a808080808080a04719db31c9528548dd84a965c46b48f8816c6dd6169f546b640e3ed4f9fd34e6808080808080";
        proofs[bob][4] = hex"ec9f200f23e9eeb794cd6b8f3944813b838b1099508a8f733f35e63e6d979a93c58b8a055888c0d241f0540000";

        // Charlie
        proofs[charlie] = new bytes[](5);
        proofs[charlie][0] =
            hex"f90211a08abd3bf0735f6c8af16b465c444641c4a4ce26a6ccb10b590eae1019ca6d91bea0a9b5dd537be664137b662a77c373714676f4083f7ad4d9ac5039d12bfbf5bf2ea0fe64994de8dcb6ee57ed536f76615cdfe5715cfe6c4c3d9d3672f9e50a906575a0788b6efd7d68a2e10de135d0d30a428b4cc48c8c0091bc6839c69f88a275fc0ba002a76ef963d5b7dac1a5203f7c21f95edb19116c598f617b164922557fe7fcfba0e2cf31c1453885eb0fea89990b965c98f6c87a990e3a781df014ff3b13abe782a0afab23c0e37eb0486d9a967737eaca36f11b64cad00415ba397336811cb5f1c1a0be4341e706c7253078250713f61928a258d1d1e8603d9549eebea97c35ec1370a04315d3979e23e56c31185b5ceab1837df84aa2b429015470e070ad26767291f4a04375376e8361af86f013615dd42ecf459165155cffaaea9db11cdba2034f87b8a06d14c99f2e7443722c789ccd1515ea3881be2450a4a998855111dbaf34b20ae9a01db567b050a6ff3b76a5b3eaf94dc25355e62204db658fbe452f8ab2342fd2aca0c62d202f910310df3ea4160682c668b0b3a311f512c281f16eda7b8c22718d10a0db1406019172879c8967003ab11be60bc817bdf6de46f7d66ed6b8c9465b74dda070656f49d5fdbc42816e002cb75d777e2d37d7c3a8cf65cae138a5ea4c743114a066fb69cc78267a40a8b2e3f3205228c35479068f7ab29fa11279852fa8ae074980";
        proofs[charlie][1] =
            hex"f90211a035a61b32334ff1db83ba353ce7dea0655b68d4565e0ca4b645868168c7169932a0f0d74db2c58a7c797abeedf0e5307ef159ad4bc1a2cf8237da8f5e7f73b674a7a02215fc8e414530c7af15e80fb5eb58b9d77c3dfd02e7cb341451aed0c53194a9a0ef21029cb9f4f5f0f642f1d1874a765a968c746fca4dcca93555b71de293c920a065b9e203ea0febc5a2c267492665a2fa2b07698bf0afe263feb7c0e4e56e4a88a0bd500854b6deb150a6c9e7d9735df6e104442595e60750432245508c723f8473a08fb4b814dda000ceba20d9ea2b0da1a6e317a3a6305f2a938a6c68937f063571a05ce7ee750a17d11695347b93bc6982c7254a58b712a8e5ea0cdcb1d640c301f0a06d8deb65cfeac289d05afa4d67e1e41e8d0f21db29c9842fa11712783f76f961a08c679ee7d43ee9fd332a154d85b4633130ab30243ae0d82f2436508d24465ffca090ab4ad2718c0a808693b1641d558ba1220058cf692028626cc5552e33c2abaaa06d748a75c8cecd77eabd1c760c5d0fba460fd374c07c4dc90be824d0319466aaa0741e7bd9630617d50dc550ed43ee55c67d0167846c551882099b055645eb9165a02c026bfb03c046c039b46254468b819101c9ddbc3371d6b4a5fd7cf76c5e5752a09dbbbc6c51ef954ed3e01f13dd2e4339b6cc53a77b068085804c955a8f13806aa039dbbbcdd8b8bb8a74a1314411fef608977f247bb9842fb18b0f095bb59cb02f80";
        proofs[charlie][2] =
            hex"f90151a077d45ed2eab47946b1642df26da6fe34adf83cb72612813de5686ebfd6e5a6a0a06a8100cefd6a1ee7e5a51e18370335e33a99c77b4b87a85f2173d9d39536445da0a7e3960f00ec6759924bf28395d55271fc8b4a4e0e9ddc6772ae7da769f0032ea0646be174586a3e45e368056e73d83d0a4125b42aaf989a174116e3e40675706d80a072330cac43f1642b8ad0c260c7d987d4d15d79e4b5bba6e9a21b651190b2234da01c5e5607c09079e32f1475514cc66a12b8a11e66aa1fad40e8366a7ee750cf1aa0a16038d6e305cb9e5be8a9e5dd3ec446738dd84fd54e8d5d840c41fd94d9619980808080a0568ac643819e5f5da88303cb599aa3f4eef49dcb632e833f0516fcdd97dd179080a088061e5b61ff03e482f75f80152e8c2c184213eafba35123fcf9e90297fda7cea0cbbce5379ddd15d05dafcf654213649378db1a1a889bf949b01aa3851ee8022880";
        proofs[charlie][3] =
            hex"f8718080a0df6daadb808cebc640643e94538dae83d15cd5154bf7338960b758c8ec6f1f2e8080808080a0edb51705685fa2adc2b9aff6671fb5ef50960e2576a5f9b518a2afff17d054e480a07ba9c58fa18549854d98b3a1f7403ecdaf930c725773dc3d8e4705b80523bdeb808080808080";
        proofs[charlie][4] =
            hex"ec9f20c7e46b9229ee478e04da93466bc9588a23ba2d51453e79a046c4018444908b8a6600e4bed9f8356dc4a1";

        box.addReward(rewardsToDistribute, merkleRoot, blockNumber, 0, totalStakedBalance);

        vm.prank(owner);
        box.setDelegator(alice, bob);
        assertEq(box.delegatorAddresses(bob), alice);

        vm.prank(bob);
        box.claim(blockNumber, proofs[alice]);

    }

}
